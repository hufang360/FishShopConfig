<!DOCTYPE html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TShock REST API</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- 自定义样式 -->
    <style type="text/css">
        .btn-outline-secondary {
            --bs-btn-border-color: var(--bs-border-color);
        }
    </style>

</head>

<body>
    <div class="container">
        <div class="row mx-1">
            <div class="input-group input-group-sm mb-1 mt-1">
                <span class="input-group-text col-1">IP</span>
                <input class="col-6 form-control" id="ip" value="127.0.0.1">
                <span class="input-group-text col-1">端口</span>
                <input class="col-6 form-control" id="port" value="7878">
            </div>

            <div class="input-group input-group-sm mb-1">
                <span class="input-group-text col-1">接口</span>
                <select class="form-select input-group-sm col-2" id="api">
                    <option value="lists/players" selected>lists/players（在线玩家）</option>
                    <option value="v2/players/list" selected>v2/players/list（在线玩家-含队伍信息）</option>
                </select>
            </div>

            <form id="form" action="#" method="get">
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text col-1">token</span>
                    <input class="col-4 form-control" type="password" id="token" name="token" value="">
                </div>
                <div>
                    <button class="btn btn-outline-secondary btn-sm col-12" onclick="submitData()">发送</button>
                </div>
            </form>

        </div>
    </div>

    <script type="text/javascript">
        if (typeof (localStorage.ip) != 'undefined') {
            document.getElementById('ip').value = localStorage.ip
        }

        if (typeof (localStorage.port) != 'undefined') {
            document.getElementById('port').value = localStorage.port
        }

        if (typeof (localStorage.token) != 'undefined') {
            document.getElementById('token').value = localStorage.token
        }

        function submitData() {
            const ipEl = document.getElementById('ip');
            const portEl = document.getElementById('port');
            const tokenEl = document.getElementById('token');
            const apiEl = document.getElementById('api');

            localStorage.ip = ipEl.value
            localStorage.port = portEl.value
            localStorage.token = tokenEl.value

            if (tokenEl.value === "") {
                alert("token不能为空！")
                return
            }

            const formEl = document.getElementById('form');
            form.action = `http://${ipEl.value}:${portEl.value}/${apiEl.value}`;
        }
    </script>
</body>

</html>